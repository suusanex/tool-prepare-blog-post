# 仕様書

## 概要
Qiitaへの記事投稿をトリガーに、Zenn・はてなブログ・LinkedInへの投稿準備を自動化するソフトウェア。Azureクラウド上でイベント駆動型に動作し、.NET AspireやOpenTelemetry等の最新技術を活用する。

---

## 1. 外部サービスのインターフェース一覧と使い方

### Qiita
- **インターフェース:** Qiita API（REST）
- **用途:** ユーザーの記事投稿検知・Markdownデータ取得
- **呼び出し方法:** ポーリング（APIにて新規投稿を定期的に確認）

### Zenn
- **インターフェース:** Zenn CLI（GitHubリポジトリ監視）
- **用途:** 下書き記事の作成、投稿検知
- **呼び出し方法:** GitHubリポジトリのWebhookまたはGitHub APIによるイベント監視（pushや新規記事追加を検知）

### はてなブログ
- **インターフェース:** AtomPub API
- **用途:** 下書き記事の作成
- **呼び出し方法:** API経由で下書き作成

### LinkedIn
- **インターフェース:** なし（APIは利用しない）
- **用途:** 投稿用文面の生成（下書き機能は無し）
- **呼び出し方法:** Qiita記事URLとテンプレートを用いて文面を生成し、Webhookでユーザーに通知

### Webhook
- **インターフェース:** HTTP POST
- **用途:** 各種処理完了時のユーザー通知

---

## 2. Azure上のサービス構成とイベントトリガー

| 処理 | Azureサービス | トリガー | 備考 |
|---|---|---|---|
| Qiita新規投稿検知 | Azure Functions（Timer Trigger） | 定期ポーリング | OpenTelemetryで監視 |
| Zenn下書き作成 | Azure Functions | Qiita投稿検知イベント | .NET Aspireで構成管理 |
| Zenn投稿検知 | Azure Functions（GitHub Webhook Trigger） | GitHubリポジトリのWebhook | pushや記事追加を検知 |
| はてなブログ下書き作成 | Azure Functions | Zenn投稿検知イベント | テンプレート適用 |
| LinkedIn文面生成・通知 | Azure Functions | Qiita投稿検知イベント | Webhookで文面通知（API不要） |
| ログ・監視 | Azure Monitor, Application Insights | 全処理 | 従量課金監視含む |

---

## 3. 使用技術
- **Azure Functions**: イベント駆動のサーバーレス処理
- **.NET Aspire**: クラウドネイティブな構成管理・デプロイ
- **OpenTelemetry**: 分散トレーシング・監視
- **Application Insights**: ログ・メトリクス収集
- **ASP.NET Core**: 必要に応じたAPIエンドポイント実装
- **Azure Monitor**: コスト・リソース監視

---

## 補足
- 各APIの認証情報はAzure Key Vaultで安全に管理
- ユーザーごとのWebhook URLはDB等で管理
- テンプレートはストレージまたはリポジトリで管理
- コスト超過時はアラートを自動送信
